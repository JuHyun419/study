## π“ TCP - 3-way Handshake & 4-way Handshake(μ‘μ„±μ¤‘)

### 3-way Handshake μ—­ν• 
  - TCPλ” μ¥μΉλ“¤ μ‚¬μ΄μ— λ…Όλ¦¬μ μΈ μ ‘μ†μ„ μ„±λ¦½(establish)ν•κΈ° μ„ν•΄ 3-way Handshakeμ„ μ‚¬μ©
  - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ λ°μ΄ν„°λ¥Ό μ „μ†΅ν•  μ¤€λΉ„κ°€ λμ—λ‹¤λ” κ²ƒμ„ λ³΄μ¥ν•κ³ , μ‹¤μ  λ°μ΄ν„° ν†µμ‹ μ΄ μ΄λ£¨μ–΄μ§€κΈ° μ „μ— ν• μ½μ΄ λ‹¤λ¥Έ μ½μ— μ¤€λΉ„λμ—λ‹¤λ” κ²ƒμ„ μ• μ μλ„λ΅ ν•¨(μ‹ λΆ°μ„±)
  - ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„ λ¨λ‘ μƒλ€νΈμ— λ€ν• μ΄κΈ°μ μμ°¨ μΌλ ¨λ²νΈλ¥Ό μ–»μ„ μ μμ

<img width="640" src="https://user-images.githubusercontent.com/50076031/123629329-203fcc00-d84f-11eb-83da-3a2ec7c5a207.png">

<br>

### 3-way Handshake μ μ°¨ (ν΄λΌμ΄μ–ΈνΈ <-> μ„λ²„)
  - ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ— μ ‘μ†μ„ μ”μ²­ν•λ” *SYN* ν¨ν‚·μ„ λ³΄λ‚Έλ‹¤.
    - ν΄λΌμ΄μ–ΈνΈλ” SYNμ„ λ³΄λ‚΄κ³  μ„λ²„λ΅λ¶€ν„° SYN/ACK μ‘λ‹µμ„ κΈ°λ‹¤λ¦¬λ” *SYN_SENT* μƒνƒκ°€ λ¨
  - μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° SYNμ”μ²­μ„ λ°›κ³  ν΄λΌμ΄μ–ΈνΈμ—κ² μ”μ²­μ„ μλ½ν•λ‹¤λ” *ACK*μ™€ SYN flagκ°€ μ„¤μ •λ ν¨ν‚·μ„ λ°μ†΅ν• ν›„ ν΄λΌμ΄μ–ΈνΈκ°€ λ‹¤μ‹ ACKμ‘λ‹µμ„ λ³΄λ‚΄κΈ°λ¥Ό κΈ°λ‹¤λ¦Ό
    - μ„λ²„λ” SYN/ACKμ„ λ³΄λ‚΄κ³  *SYN_RECEIVED* μƒνƒκ°€ λ¨
  - ν΄λΌμ΄μ–ΈνΈλ” λ‹¤μ‹ μ„λ²„μ—κ² ACKμ„ λ³΄λ‚Έ ν›„ μ—°κ²°μ΄ μ΄λ£¨μ–΄μ§€κ³  λ°μ΄ν„°μ ν†µμ‹ μ΄ μ΄λ£¨μ–΄μ§
    - μ΄λ• μ„λ²„μ μƒνƒλ” *ESTABLISHED*κ°€ λ¨
  - μ„μ™€ κ°™μ΄ ν΄λΌμ΄μ–ΈνΈμ™€ μ„λ²„κ°€ ν†µμ‹ μ„ ν•κΈ° μ „ μ‹ λΆ°μ„±μλ” μ—°κ²°μ„ λ§Ίμ–΄ μ¤€λ‹¤λ” κ²ƒμ΄ TCPμ 3-way Handshake

<br>

### κ° μ©μ–΄ μ„¤λ…

```html
* SYN(Synchronization): μƒλ€μ— λ€ν• μ ‘μ† μ”μ²­

* ACK(Acknowledgement): μƒλ€μ ν†µμ‹  μ‘λ‹µ

* SYN_SENT: ν΄λΌμ΄μ–ΈνΈκ°€ μ§μ ‘ μ„λ²„μ—κ² μ‹ν€€μ¤ λ²νΈμ„ μƒμ„±ν•μ—¬ SYN ν¨ν‚·μ— λ‹΄μ•„ λ³΄λƒ„
  - SYN(seq = m)

* SYN_RECEIVED: ν΄λΌμ΄μ–ΈνΈλ΅λ¶€ν„° SYNν¨ν‚·μ„ λ°›μ€ μ„λ²„λ” μμ‹ λ§μ μ‹ν€€μ¤ λ²νΈλ¥Ό μƒμ„±ν•κ³  SYN ν¨ν‚·μ— λ‹΄μ•„ ν΄λΌμ΄μ–ΈνΈμ SYN ν¨ν‚·μ— μλ” μ‹ν€€μ¤ λ²νΈμ— +1μ„ λ”ν• ν›„ ACK ν¨ν‚·μ— λ‹΄μ•„μ„ κ°™μ΄ λ³΄λƒ„
  - SYN(seq = n), ACK(ack = m+1)

* (Client) ESTABLISHED: μ„λ²„λ΅λ¶€ν„° SYN + ACK ν¨ν‚·μ„ λ°›μ€ ν΄λΌμ΄μ–ΈνΈλ” ACK ν¨ν‚·μ μ‹ν€€μ¤ λ²νΈλ¥Ό λ³΄κ³  μμ‹ μ΄ λ³΄λ‚Έ μ‹ν€€μ¤ λ²νΈμ™€ μ°¨μ΄κ°€ 1μ„μ„ ν™•μΈν•¨
μ°¨μ΄κ°€ 1μ΄λΌλ©΄ μ λ€λ΅ μ—°κ²°λμ—λ‹¤κ³  νλ‹¨ν•κ³ , μ„λ²„μ SYN ν¨ν‚·μ— μλ” μ‹ν€€μ¤ λ²νΈμ— +1μ„ λ”ν• ν›„ ACK ν¨ν‚·μ— λ‹΄μ•„ λ³΄λƒ„
  - SYN(ack = n+1)

* (Server) ESTABLISHED: ν΄λΌμ΄μ–ΈνΈμ ACK ν¨ν‚·μ„ λ°›κ³  ν¨ν‚·μ— μ΅΄μ¬ν•λ” μ‹ν€€μ¤ λ²νΈκ°€ μ΄μ „μ— λ³΄λ‚Έ SYN ν¨ν‚·μ μ‹ν€€μ¤ λ²νΈ + 1κ³Ό λ™μΌν•λ‹¤λ©΄ μ—°κ²°μ΄ λμ—λ‹¤κ³  νλ‹¨ν•¨
  - ACK(ack = n+1)
```

<img width="640" src="https://user-images.githubusercontent.com/50076031/123632337-c7723280-d852-11eb-9db5-0a9a252e207d.png">













<br><br>

### References
  - https://mindnet.tistory.com/entry/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0-22%ED%8E%B8-TCP-3-WayHandshake-4-WayHandshake
  - https://velog.io/@ss-won/%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-TCP-3-way-handshake
  - https://afteracademy.com/blog/what-is-a-tcp-3-way-handshake-process
