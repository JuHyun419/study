## M:N(다대다) 관계와 파일 업로드 처리
  - 영화(Movie), 회원(Member) 다대다 관계
  - 대표적인 M:N(다대다) 관계
    - 학생과 수업: 한 명의 학생은 여러 수업에 참여하고, 하나의 수업은 여러 학생이 수강
    - 상품과 상품 카테고리: 하나의 상품은 여러 카테고리에 속하고, 하나의 카테고리는 여러 상품을 가지고 있다.
    - 상품과 회원: 하나의 상품은 여러 회원이 구매할 수 있고, 한 명의 회원은 여러 상품을 구매할 수 있다.
  - M:N(다대다)를 해결하기 위해 실제 테이블 설계에서는 매핑(mapping) 테이블을 사용(연결 테이블)
    - 영화 -> 리뷰 <- 회원
  - 매핑 테이블의 특징
    - 매핑 테이블의 작성 이전에 다른 테이블들이 먼저 존재해야 함
    - 매핑 테이블은 주로 '명사'가 아닌 '동사'나 '히스토리'에 대한 데이터를 보관하는 용도
    - 매핑 테이블은 중간에서 양쪽의 PK를 참조하는 형태로 사용됨
  - JPA에서 M:N을 처리하는 방식큰 크게 두 가지
    - @ManyToMany를 이용해 처리
    - 별도의 엔티티를 설계하고, @ManyToOne을 이용해서 처리하는 방식
  - 실무에서 가능하면 '단방향 참조'(위 두 번째 방식)을 위주로 프로젝트를 진행함
    - JPA의 실행에서 가장 중요한 것이 현재 메모리상의 엔티티 객체들의 상태와 DB의 상태를 동기화 시키는 점
    - 하나의 객체를 수정하는 경우 다른 객체의 상태를 매번 일치하도록 변경하는 작업은 그다지 간단하지 않음

### Entity 설계
  - M:N(다대다) 관계 처리 시 매핑 테이블의 설계는 마지막 단계에서 처리
  - '명사'에 해당하는 클래스를 먼저 설계
  - 매핑 테이블은 주로 '동사'나 '히스토리'를 의미하는 테이블
  - '회원이 영화에 대해서 평점을 준다' -> '평점을 준다'는 행위가 매핑 테이블이 필요한 부분
  - 100명 회원 생성 -> 100개의 영화, 영화 이미지 생성 -> 200개의 영화 리뷰(매핑 테이블) 생성

### 영화 목록 화면
  - 영화, 영화 이미지, 리뷰 수, 평점 평균 출력
  - @EntityGraph: 엔티티의 특정 속성을 같이 로딩하도록 표시하는 어노테이션
    - attributePaths: 로딩 설정을 변경하고 싶은 속성의 이름을 배열로 명시
    - type: @EntityGraph를 어떤 방식으로 적용할 것인지 설정
    - FATCH 속성값은 attributePaths에 명시한 속성은 EAGER로 처리하고, 나머지는 LAZY로 처리
    - LOAD 속성값은 attributePaths에 명시한 속성은 EAGER로 처리하고, 나머지는 엔티티 클래스에 명시되거나 기본 방식으로 처리
    
## 파일 업로드 처리
  - 서블릿 기반으로 처리
  - application.properties 파일에 multipart 관련 추가(파일 처리)

#### 파일 저장 단계에서는 다음 사항들을 고려해야 함
  - 업로드된 확장자가 이미지만 가능하도록 검사
    - MultipartFile에서 제공하는 getContentType()을 이용해서 처리
  - 동일한 이름의 파일이 업로드 된다면 기존 파일을 덮어쓰는 문제
    - 시간 추가 or UUID 이용
  - 업로드된 파일을 저장하는 폴더의 용량
    - 년/월/일 폴더를 따로 생성해서 파일 저장
    

#### 썸네일(Thumbnail) 처리
  - 업로드된 파일을 저장하고 썸네일 라이브러리(net.coobird Thumbnailator) 를 활용해서 썸네일 파일 생성
  - 썸네일 파일은 맨 앞 's_'를 붙여서 일반 파일과 구분
  - Dto에 썸네일의 Url을 받아오는 메소드 추가 --> <img> 태그로 처리